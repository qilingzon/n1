<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NodeCrypt - 管理员控制台</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/body.css">
  <link rel="stylesheet" href="css/phone.css">
  <link rel="stylesheet" href="css/form-animation.css">
  <link rel="stylesheet" href="css/admin.css">
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
  <style>
    /* 添加一个预加载样式，避免闪烁 */
    .preload * {
      -webkit-transition: none !important;
      -moz-transition: none !important;
      -ms-transition: none !important;
      -o-transition: none !important;
      transition: none !important;
    }
  </style>
</head>
<body class="preload">
  <div class="admin-container">
    <!-- 侧边栏 -->
    <div class="admin-sidebar">
      <div class="admin-header">
        <h1>管理员控制台</h1>
        <div class="admin-user-info">
          <span id="admin-username"></span>
          <span class="admin-badge">管理员</span>
        </div>
      </div>

      <nav class="admin-nav">
        <a href="#users" class="admin-nav-item active" data-section="users">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="currentColor"/>
          </svg>
          <span>用户管理</span>
        </a>
        <a href="#settings" class="admin-nav-item" data-section="settings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.14 12.94C19.18 12.64 19.2 12.33 19.2 12C19.2 11.68 19.18 11.36 19.13 11.06L21.16 9.48C21.34 9.34 21.39 9.07 21.28 8.87L19.36 5.55C19.24 5.33 18.99 5.26 18.77 5.37L16.38 6.43C15.88 6.05 15.35 5.74 14.76 5.51L14.4 2.93C14.36 2.68 14.16 2.5 13.91 2.5H10.09C9.84 2.5 9.65 2.68 9.61 2.93L9.25 5.51C8.66 5.74 8.12 6.05 7.63 6.43L5.24 5.37C5.02 5.26 4.77 5.32 4.65 5.55L2.74 8.87C2.62 9.08 2.66 9.34 2.86 9.48L4.89 11.06C4.84 11.36 4.8 11.69 4.8 12C4.8 12.31 4.82 12.64 4.87 12.94L2.84 14.52C2.66 14.66 2.61 14.93 2.72 15.13L4.64 18.45C4.76 18.67 5.01 18.74 5.23 18.63L7.62 17.57C8.12 17.95 8.65 18.26 9.24 18.49L9.6 21.07C9.65 21.32 9.84 21.5 10.09 21.5H13.91C14.16 21.5 14.36 21.32 14.39 21.07L14.75 18.49C15.34 18.26 15.88 17.95 16.37 17.57L18.76 18.63C18.98 18.74 19.23 18.68 19.35 18.45L21.27 15.13C21.39 14.92 21.34 14.66 21.15 14.52L19.14 12.94ZM12 15.6C10.01 15.6 8.4 13.99 8.4 12C8.4 10.01 10.01 8.4 12 8.4C13.99 8.4 15.6 10.01 15.6 12C15.6 13.99 13.99 15.6 12 15.6Z" fill="currentColor"/>
          </svg>
          <span>系统设置</span>
        </a>
      </nav>

      <div class="admin-footer">
        <a href="/index.html" class="admin-link">返回聊天</a>
        <button id="logout-btn" class="admin-logout-btn">退出登录</button>
      </div>
    </div>

    <!-- 主内容区 -->
    <div class="admin-main">
      <!-- 用户管理部分 -->
      <div id="users-section" class="admin-section active">
        <div class="section-header">
          <h2>用户管理</h2>
          <div class="section-actions">
            <button id="refresh-users-btn" class="admin-btn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4C7.58 4 4.01 7.58 4.01 12C4.01 16.42 7.58 20 12 20C15.73 20 18.84 17.45 19.73 14H17.65C16.83 16.33 14.61 18 12 18C8.69 18 6 15.31 6 12C6 8.69 8.69 6 12 6C13.66 6 15.14 6.69 16.22 7.78L13 11H20V4L17.65 6.35Z" fill="currentColor"/>
              </svg>
              刷新
            </button>
          </div>
        </div>

        <div class="users-table-container">
          <table class="users-table">
            <thead>
              <tr>
                <th>用户名</th>
                <th>角色</th>
                <th>注册时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="users-table-body">
              <!-- 用户数据将通过JavaScript动态加载 -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- 系统设置部分 -->
      <div id="settings-section" class="admin-section">
        <div class="section-header">
          <h2>系统设置</h2>
        </div>

        <div class="settings-container">
          <div class="setting-item">
            <h3>系统信息</h3>
            <div class="setting-info">
              <div class="info-row">
                <span class="info-label">系统版本:</span>
                <span class="info-value">1.0.0</span>
              </div>
              <div class="info-row">
                <span class="info-label">部署平台:</span>
                <span class="info-value">Cloudflare Workers</span>
              </div>
            </div>
          </div>

          <div class="setting-item">
            <h3>管理员操作</h3>
            <div class="setting-actions">
              <button id="clear-cache-btn" class="admin-btn">清除缓存</button>
              <button id="reset-system-btn" class="admin-btn danger">重置系统</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 用户角色编辑模态框 -->
  <div id="role-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>修改用户角色</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="user-role">选择角色:</label>
          <select id="user-role">
            <option value="user">普通用户</option>
            <option value="admin">管理员</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="admin-btn secondary" id="cancel-role-btn">取消</button>
        <button class="admin-btn primary" id="save-role-btn">保存</button>
      </div>
    </div>
  </div>

  <!-- 删除用户确认模态框 -->
  <div id="delete-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>确认删除用户</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <p>确定要删除用户 <span id="delete-username"></span> 吗？此操作不可撤销。</p>
      </div>
      <div class="modal-footer">
        <button class="admin-btn secondary" id="cancel-delete-btn">取消</button>
        <button class="admin-btn danger" id="confirm-delete-btn">删除</button>
      </div>
    </div>
  </div>

  <!-- 消息提示 -->
  <div class="message-container" id="message-container"></div>

  <script type="module" src="./js/admin-ui.js"></script>
</body>
</html>
